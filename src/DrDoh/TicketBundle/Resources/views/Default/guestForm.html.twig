{% extends "::layout.html.twig"%}

{% block title %} 
    {{parent()}} Billetterie 
{% endblock %}

{% block body  %}
   <div class="container">
        <h2 class="text-white m-4">Bienvenue</h2> 
   
        <div class="card text-white bg-dark mb-3">
            <h3 class="card-header text-center">
            <em>
                Vous prevoyez une visite pour la {{app.request.request.get("choix")}} du {{app.request.request.get("date")}} <br>
                <br>
                Indiquez vos coordonnées pour la reservation de {{app.request.request.get("ticket_qte")}} billet(s).  
            <em>
            </h3>
{# vvvvv ------------vvvvvvv---------FORMULAIRE(S) BUYER ------------vvvvvvv---------vvvvv #}
                    {{form_start(form)}}
            <div class="card-body" id="form_card">
                <div class="text-right">
                    <h4 class="text-right" id="guest_index"></h4>
                </div>    
                <div class="well">
                        {{form_errors(form)}}
                        {# NOM + PRENOM #}
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                {{form_errors(form.lastName)}}
                                {{form_widget(form.lastName)}}
                            </div>

                            <div class="form-group col-md-6">
                                {{form_errors(form.firstName)}}
                                {{form_widget(form.firstName)}}
                            </div>
                        </div>
                        {# DATE DE NAISSANCE + REDUCTION + PAYS #}
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                {{form_errors(form.birthDate)}}
                                {{form_widget(form.birthDate)}}
                            </div>
                            <div class="form-group col-md-4">
                                {{form_errors(form.discount)}}
                                {{form_widget(form.discount)}}
                            </div>
                            <div class="form-group col-md-4">
                                {{form_errors(form.country)}}
                                {{form_widget(form.country)}}
                            </div>
                        </div>
                        {# EMAIL #}
                        <div class="form-row">
                        <div class="form-group col-md-12">
                                {{form_errors(form.email)}}
                                {{form_widget(form.email)}}
                            </div>
                        </div>
                </div>
            </div>
        <br>
{# vvvvv ------------vvvvvvv---------TABLEAU DE PRIX ------------vvvvvvv---------vvvvv #}       
        <div class="card text-white bg-dark mb-3">
            <h3 class="card-header text-center">
                Montant de votre commande
            </h3>
            <div class="card-body">
                <div class="well text-dark">
                    <table class="table table-striped table-light table-bordered">
                        <thead>
                            <tr>
                            <th scope="col">Billets</th>
                            <th scope="col">Quantité</th>
                            <th scope="col">Tarif unitaitre</th>
                            <th scope="col">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                            <th scope="row">Plein Tarif</th>
                            <td id="qte_full_price" class="text-center">0</td>
                            <td id="one_full_price" class="text-center">16,00 €</td>
                            <td id="total_full_price" class="text-center"></td>
                            </tr>
                            <tr>
                            <th scope="row">Tarif enfant</th>
                            <td id="qte_child_price" class="text-center">0</td>
                            <td id="one_child_price" class="text-center">8,00 €</td>
                            <td id="total_child_price" class="text-center"></td>
                            </tr>
                            <tr>
                            <th scope="row">Tarif bébé</th>
                            <td id="qte_baby_price" class="text-center">0</td>
                            <td id="one_baby_price" class="text-center">0,00 €</td>
                            <td id="total_baby_price" class="text-center"></td>
                            </tr>
                            <th scope="row">Tarif Senior</th>
                            <td id="qte_older_price" class="text-center">0</td>
                            <td id="one_older_price" class="text-center">12,00 €</td>
                            <td id="total_older_price" class="text-center"></td>
                            </tr>
                            <th scope="row">Tarif réduit</th>
                            <td id="qte_discount_price" class="text-center">0</td>
                            <td id="one_discount_price" class="text-center">10,00 €</td>
                            <td id="total_discount_price" class="text-center"></td>
                            </tr>
                        </tbody>
                        <tfooter>
                            <tr>
                            <th scope="row"></th>
                            <td></td>
                            <th>Total</th>
                            <td id="total_price" class="text-center"></td>
                            </tr>
                        </tfooter>
                    </table>
{# vvvvv ------------vvvvvvv---------VALIDATION DE FORMULAIRE ------------vvvvvvv---------vvvvv #}                  
                <div class="mx-auto text-center alert alert-secondary">
                    {{form_widget(form.agreed, {'label': "En cochant cette case, vous confirmez avoir lu et accepter les <a href=''>conditions générales d'utilisation</a>"})}}
                </div>
                
                <div class="mx-auto ">
                    {{form_widget(form.save,{ 'label': 'Poursuivre','attr':{'class':'btn btn-info btn-lg btn-block'}})}}

                    {{form_rest(form)}}
                    {{form_end(form)}}
                </div>
            </div>
        </div>
    </div> 

{% endblock %}
{# vvvvv ------------vvvvvvv--------- SCRIPT JS ------------vvvvvvv---------vvvvv #} 
{% block javascripts %}
 {{parent()}}
<script type="text/javascript" src="{{ asset('js/form_generator.js') }}"></script>
<script type="text/javascript" src="{{ asset('js/ticket_price_calculator.js') }}"></script>
<script type="text/javascript" src="{{ asset('js/mybox.js') }}"></script>
<script>

$(document).ready(function() {

    var Qte = parseInt("{{ticket_qte}}");
    var formSelector = "#drdoh_ticketbundle_buyer_";
    var items = ["full" , "child" , "baby" , "older" , "discount" ];
    var labels = ["lastName","firstName","birthDate","discount","country",]


    formGenerator.init(Qte,formSelector,labels);
    price.init(Qte,formSelector,items);
    
    mybox.init();

    
})

</script>


{% endblock %}

    
